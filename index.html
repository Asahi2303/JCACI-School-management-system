<!DOCTYPE html>
<html lang="en">
  <head>
    <!--
      Jolly Children Academic Center, Inc. — Single Page Website
      Tech: Pure HTML5, CSS3, and minimal vanilla JS. One self-contained file.
      Notes:
      - Edit text content directly in sections below.
      - Colors are controlled via CSS variables in :root.
      - Accessible, responsive, mobile‑first, with reduced‑motion support.
    -->

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Jolly Children Academic Center, Inc.</title>
    <meta name="description" content="Jolly Children Academic Center, Inc. nurtures bright minds and big hearts through inclusive, engaging learning from early childhood to middle school." />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Jolly Children Academic Center, Inc." />
    <meta property="og:description" content="Nurturing bright minds and big hearts across vibrant, inclusive programs." />
    <meta property="og:image" content="https://via.placeholder.com/1200x630.png?text=Jolly+Children+Academic+Center" />
    <meta property="og:url" content="https://example.com" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Jolly Children Academic Center, Inc." />
    <meta name="twitter:description" content="Nurturing bright minds and big hearts across vibrant, inclusive programs." />
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630.png?text=Jolly+Children+Academic+Center" />
  <meta name="color-scheme" content="light dark" />

    <!-- Favicon placeholder -->
    <link rel="icon" href="/favicon.ico" /> 

    <!-- Google Fonts: Poppins (headings) and Inter (body) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Poppins:wght@600;700&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>

    <div id="fb-root"></div>
    <!-- Facebook SDK: load only if a real app id is provided. If not, use the iframe fallback. -->
    <meta name="facebook-app-id" content="APP_ID">
    <script>
      (function() {
        try {
          var appId = document.querySelector('meta[name="facebook-app-id"]').getAttribute('content') || '';
          // If placeholder or empty, do not load SDK and rely on iframe fallback.
          if (!appId || appId === 'APP_ID' || appId.trim() === '') {
            console.info('Facebook appId missing or placeholder — using iframe fallback.');
            // Reveal iframe fallback immediately (if present)
            window.addEventListener('load', function () {
              var iframeWrap = document.querySelector('.fb-page-iframe-wrapper');
              if (iframeWrap) {
                iframeWrap.style.display = 'block';
                iframeWrap.setAttribute('aria-hidden', 'false');
              }
            });
            return;
          }
          // Otherwise dynamically insert FB SDK with provided appId
          var s = document.createElement('script');
          s.async = true; s.defer = true; s.crossOrigin = 'anonymous';
          s.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v23.0&appId=' + encodeURIComponent(appId);
          document.head.appendChild(s);
        } catch (e) {
          console.warn('Error while configuring Facebook SDK:', e && e.message ? e.message : e);
        }
      })();
    </script>

    <!-- Announcement bar (dismissible) -->
    <div class="announce" role="region" aria-label="Announcement" id="announce" hidden>
      <div class="container">
        <div>
          Enrollment for SY 2025–2026 is now open. Visit Admissions to get started!
        </div>
        <button class="dismiss" type="button" aria-label="Dismiss announcement">Dismiss</button>
      </div>
    </div>
    <!--
      Accessible sticky header with brand and navigation.
      Update nav links if you change section IDs.
    -->
    <header class="site-header" role="banner">
      <div class="container nav">
        <a class="brand" href="#home">
          <img src="resources\brand logo\images-removebg-preview.png" alt="Jolly Children Academic Center Logo" class="brand-logo">
          <span class="brand-text">Jolly Children Academic Center, Inc.</span>
        </a>

        <!-- Mobile menu toggle -->
        <button class="menu-toggle" aria-expanded="false" aria-controls="primary-navigation">
          <span class="bars" aria-hidden="true"><span class="bar"></span></span>
          <span class="sr-only">Menu</span>
        </button>

        <!-- Primary navigation -->
        <nav id="primary-navigation" class="nav-panel" aria-label="Primary">
          <div class="nav-links" role="menubar">
            <a role="menuitem" href="#home" class="nav-link">Home</a>
            <a role="menuitem" href="#about" class="nav-link">About Us</a>
            <a role="menuitem" href="#academics" class="nav-link">Academics</a>
            <a role="menuitem" href="#facilities" class="nav-link">Facilities</a>
            <a role="menuitem" href="#admissions" class="nav-link">Admissions</a>
            <a role="menuitem" href="#contact" class="nav-link">Contact</a>
            <button id="theme-toggle" type="button" class="btn secondary" style="margin-left:0.5rem;" aria-pressed="false" aria-label="Activate dark mode">🌙</button>
          </div>
        </nav>
      </div>
    </header>

    <main id="home" tabindex="-1">
      <!-- Hero Section -->
      <section class="hero" aria-labelledby="hero-title">
        <div class="container hero-wrap reveal">
          <div>
            <h1 id="hero-title">Jolly Children Academic Center, Inc.</h1>
            <p class="lead">LEARNING BY HEART FOR A BRIGHTER START. </p>
            <div class="cta" role="group" aria-label="Primary actions">
              <a class="btn" href="#about">Learn More</a>
              <a class="btn secondary" href="#admissions">Admissions</a>
            </div>
          </div>
          <div class="hero-card" aria-hidden="false">
            <button class="hero-img hero-lightbox-trigger" aria-label="Open hero image">
              <!-- Optional: Replace with an accessible image below -->
              <img src="resources\brand logo\schoolpic.jpg"  /> 
            </button>
          </div>
        </div>
      </section>

      <!-- About Us -->
      <section id="about" class="container reveal" aria-labelledby="about-title">
        <div class="section-header">
          <h2 id="about-title">About Us</h2>
          <p class="lead">We are a joyful, student‑centered community committed to excellent, inclusive education.</p>
        </div>
        <div class="grid">
          <div>
            <p>
              Our mission is to provide a nurturing and stimulating environment where children can grow academically, socially, and emotionally. We believe in fostering a love for learning that lasts a lifetime.
            </p>
          </div>
        </div>

        <!-- Highlights -->
        <div class="grid cols-3" style="margin-top: 1rem;">
          <article class="card" aria-label="Safe and Inclusive">
            <div class="icon" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
            </div>
            <h3>Safe & Inclusive</h3>
            <p>Warm, welcoming spaces where every child is respected and supported.</p>
          </article>
          <article class="card" aria-label="Engaging Curriculum">
            <div class="icon" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M3 5h18M3 12h18M3 19h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            </div>
            <h3>Engaging Curriculum</h3>
            <p>Balanced academics with arts, play, and inquiry‑based learning.</p>
          </article>
          <article class="card" aria-label="Dedicated Faculty">
            <div class="icon" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Zm7 10v-1a6 6 0 0 0-12 0v1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            </div>
            <h3>Dedicated Faculty</h3>
            <p>Experienced educators who know and celebrate each learner.</p>
          </article>
        </div>
      </section>

      <!-- Stats Section -->
      <section class="container reveal" aria-labelledby="stats-title">
        <div class="section-header">
          <h2 id="stats-title">At a Glance</h2>
          <p class="lead">A joyful place to learn and grow.</p>
        </div>
        <div class="stats" aria-label="School statistics">
          <div class="stat">
            <div class="num" id="stat-total-students" data-count="450">0</div>
            <div class="label">Happy Students</div>
          </div>
          <div class="stat">
            <div class="num" id="stat-total-staff" data-count="48">0</div>
            <div class="label">Caring Staff</div>
          </div>
          <div class="stat">
            <div class="num" id="stat-total-clubs" data-count="15">0</div>
            <div class="label">Clubs & Teams</div>
          </div>
          <div class="stat">
            <div class="num" id="stat-years-of-joy" data-count="12">0</div>
            <div class="label">Years of Joy</div>
          </div>
        </div>
      </section>

      <!-- Academics -->
      <section id="academics" class="container reveal" aria-labelledby="academics-title">
        <div class="section-header">
          <h2 id="academics-title">Academics</h2>
          <p class="lead">Programs that grow with your child from early years to middle school.</p>
        </div>
        <!-- Filter chips (interactive) -->
        <div class="chip-group" role="group" aria-label="Filter programs">
          <button class="chip" type="button" data-filter="all" aria-pressed="true">All</button>
          <button class="chip" type="button" data-filter="early">Early Childhood</button>
          <button class="chip" type="button" data-filter="elementary">Elementary</button>
          <button class="chip" type="button" data-filter="middle">Middle School</button>
          <button class="chip" type="button" data-filter="enrichment">Enrichment</button>
        </div>
        <div class="grid cols-3" id="academics-grid">
          <article class="card" data-tags="early" aria-label="Preschool / Early Childhood">
            <div class="icon" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 2 2 7l10 5 10-5-10-5Zm0 20V12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
            <h3>Preschool / Early Childhood</h3>
            <p>Play‑rich experiences that build language, numeracy, and social skills.</p>
          </article>
          <article class="card" data-tags="elementary" aria-label="Elementary">
            <div class="icon" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M4 21v-8l8-4 8 4v8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
            <h3>Elementary</h3>
            <p>Strong foundations in literacy, math, science, and creative expression.</p>
          </article>
          <article class="card" data-tags="middle" aria-label="Middle School">
            <div class="icon" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5-5 5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
            <h3>Middle School</h3>
            <p>Inquiry projects, leadership, and deeper study across disciplines.</p>
          </article>
          <article class="card" data-tags="enrichment" aria-label="Special Programs & Support">
            <div class="icon" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 8v8m-4-4h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            </div>
            <h3>Special Programs & Support</h3>
            <p>Targeted supports and enrichment to meet diverse learning needs.</p>
          </article>
          <article class="card" data-tags="enrichment" aria-label="Clubs & Activities">
            <div class="icon" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
            <h3>Clubs & Activities</h3>
            <p>Arts, athletics, and interest‑based clubs that build joy and teamwork.</p>
          </article>
        </div>
      </section>

      <!-- Facilities -->
      <section id="facilities" class="container reveal" aria-labelledby="facilities-title">
        <div class="section-header">
          <h2 id="facilities-title">Our Facilities</h2>
          <p class="lead">Modern, safe, and inspiring spaces designed for learning and growth.</p>
        </div>
        <div class="grid cols-3" id="facilities-grid">
          <!-- Facilities will be populated by JavaScript -->
        </div>
      </section>

      <!-- Testimonials Carousel (enhanced widget) -->
      <section class="container reveal" aria-labelledby="testimonials-title">
        <div class="section-header">
          <h2 id="testimonials-title">What Families Say</h2>
          <p class="lead">Voices from our community.</p>
        </div>
        <div id="testimonials-widget" class="testimonials-widget">
          <div class="testimonials-card" aria-roledescription="carousel" aria-label="What Families says">
            <button class="carousel-btn prev" id="testi-prev" aria-label="Previous testimonial">❮</button>

            <div class="testi-viewport">
              <div class="testi-track" id="testi-track">
              <!-- slides inserted by enhanced JS -->
              </div>
            </div>

            <button class="carousel-btn next" id="testi-next" aria-label="Next testimonial">❯</button>
          </div>

          <div class="testi-dots" id="testi-dots" role="tablist" aria-label="Testimonial navigation"></div>
          <div id="testi-announcer" class="sr-only" aria-live="polite"></div>
        </div>
      </section>

      <!-- Admissions -->
      <section id="admissions" class="container reveal" aria-labelledby="admissions-title">
        <div class="section-header">
          <h2 id="admissions-title">Admissions</h2>
          <p class="lead">Your path to joining our community, step by step.</p>
        </div>

        <!-- Steps -->
        <div class="steps" aria-label="Admissions steps">
          <div class="step"><div></div><div><strong>Inquire</strong><br/>Reach out with questions—our team is happy to help.</div></div>
          <div class="step"><div></div><div><strong>Visit</strong><br/>Tour campus and experience our joyful classrooms.</div></div>
          <div class="step"><div></div><div><strong>Apply</strong><br/>Submit an application—our admissions team will guide you.</div></div>
          <div class="step"><div></div><div><strong>Assessment</strong><br/>A friendly, age‑appropriate skills and readiness check.</div></div>
          <div class="step"><div></div><div><strong>Enrollment</strong><br/>Complete forms and get ready for a great year!</div></div>
        </div>

        <!-- FAQ Accordion (view‑only) -->
        <div class="accordion" style="margin-top: 1rem;" role="region" aria-labelledby="faq-title">
          <h3 id="faq-title" class="sr-only">Admissions FAQ</h3>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false" aria-controls="faq1" id="faq1-header">
              What ages do you serve?
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <div id="faq1" class="accordion-panel" role="region" aria-labelledby="faq1-header" hidden>
              We welcome learners from preschool through middle school.
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false" aria-controls="faq2" id="faq2-header">
              When should we apply?
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <div id="faq2" class="accordion-panel" role="region" aria-labelledby="faq2-header" hidden>
              Applications open in the fall; rolling review continues while space remains.
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false" aria-controls="faq3" id="faq3-header">
              Do you offer financial assistance?
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </button>
            <div id="faq3" class="accordion-panel" role="region" aria-labelledby="faq3-header" hidden>
              Yes—limited scholarships and tuition assistance are available. Please inquire.
            </div>
          </div>
        </div>

        <div style="margin-top: 1rem;">
          <a class="btn" href="#contact">Contact Admissions</a>
        </div>
      </section>

      <!-- Contact -->
      <section id="contact" class="container reveal" aria-labelledby="contact-title">
        <div class="section-header">
          <h2 id="contact-title">Stay Connected</h2>
          <p class="lead">Follow our updates, get in touch, or find our location below.</p>
        </div>

      
        <div class="facebook-plugin-container">
          <div class="fb-embed-wrapper">
            <!-- Primary: XFBML-based page plugin (requires FB SDK + valid appId). -->
            <div class="fb-page" 
              data-href="https://www.facebook.com/profile.php?id=61561035262591" 
              data-tabs="timeline" 
              data-width="500"
              data-small-header="true" 
              data-adapt-container-width="true" 
              data-hide-cover="false" 
              data-show-facepile="true">
              <blockquote cite="https://www.facebook.com/profile.php?id=61561035262591" class="fb-xfbml-parse-ignore">
                <a href="https://www.facebook.com/profile.php?id=61561035262591">Facebook</a>
              </blockquote>
            </div>

            <!-- Fallback: iframe-based Page Plugin. This does not require the FB SDK or appId and is reliable across ports/origins. -->
            <div class="fb-page-iframe-wrapper" aria-hidden="true" style="display:none;">
              <iframe title="Facebook page" class="fb-page-iframe" src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Fprofile.php%3Fid%3D61561035262591&tabs=timeline&width=500&height=400&small_header=true&adapt_container_width=true&hide_cover=false&show_facepile=true" loading="lazy" style="border:none;overflow:hidden;width:100%;height:400px;" scrolling="no" frameborder="0" allowTransparency="true" allow="encrypted-media"></iframe>
            </div>
          </div>
        </div>

        <!-- Duplicate 'families' testimonial section removed - enhanced testimonials widget lives in the main Testimonials section above -->

        <div class="contact-grid">
          <div class="contact-card">
            <h3>Get in Touch</h3>
            <ul class="contact-list" aria-label="School contact information">
              <li><strong>Address:</strong> Block 33, Lot 45, Phase 1A, Kasiglahan Village, San Jose 1860 Rodriguez, Philippines</li>
              <li><strong>Phone:</strong> Mrs. Amelia B. Lara - 09610582640</li>
              <li><strong></strong> Mrs. Jennilyn R. Torres - 09184440180</li>
              <li><strong>Email:</strong> <span id="school-email">
lara071970@gmail.com</span> <span class="inline-actions"><button type="button" class="copy-btn" data-copy="#school-email">Copy</button></span></li>
              <li><strong>Office Hours:</strong> Mon–Fri, 8:00 AM – 4:00 PM</li>
            </ul>
            <iframe class="map" title="Map to Jolly Children Academic Center" loading="lazy" allowfullscreen referrerpolicy="no-referrer-when-downgrade" style="border:0;"
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3858.4364782813063!2d121.13901967587603!3d14.744422073537748!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3397bb30da13167b%3A0x5e53164ff18bfe1f!2sJolly%20Children%20Academic%20Center%2C%20Inc.!5e0!3m2!1sen!2sph!4v1758271627238!5m2!1sen!2sph"></iframe>
          </div>

          <div class="contact-card" aria-labelledby="form-title">
            <h3 id="form-title">Contact Form</h3>
            <form class="form" id="contact-form" action="/api/contact" method="POST" novalidate aria-describedby="form-note">
              <!-- Honeypot fields (hidden to users, visible to bots) -->
              <div style="position:absolute;left:-5000px;top:auto;width:1px;height:1px;overflow:hidden;">
                <label>Do not fill: <input type="text" name="website" tabindex="-1" autocomplete="off"></label>
                <label>Leave empty: <input type="text" name="phone" tabindex="-1" autocomplete="off"></label>
              </div>
              <div class="field">
                <label for="name">Name</label>
                <input id="name" name="name" type="text" inputmode="text" autocomplete="name" placeholder="Your full name" required />
              </div>
              <div class="field">
                <label for="email">Email</label>
                <input id="email" name="email" type="email" inputmode="email" autocomplete="email" placeholder="you@example.com" required />
              </div>
              <div class="field">
                <label for="message">Message</label>
                <textarea id="message" name="message" placeholder="How can we help?" minlength="10" required></textarea>
              </div>
              <button class="btn" type="submit">Send Message</button>
              <p id="form-note" class="form-note" role="status" aria-live="polite"></p> <!-- For status messages -->
            </form>
          </div>
        </div>
      </section>
    </main>

    

    <footer role="contentinfo">
      <div class="container footer-grid">
        <div>
          <div class="quick-links" aria-label="Quick links">
            <a href="#home">Home</a>
            <a href="#about">About Us</a>
            <a href="#academics">Academics</a>
            <a href="#facilities">Facilities</a>
            <a href="#admissions">Admissions</a>
            <a href="#contact">Contact</a>
          </div>
          <p class="copyright">© <span id="year"></span> Jolly Children Academic Center, Inc. All rights reserved.</p>
        </div>
        <div class="socials" aria-label="Social media">
          <a href="#" aria-label="Facebook">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3V2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </a>
          <a href="#" aria-label="Twitter">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M23 3s-2 .9-3 1 0 0 0 0c-1-1.1-2.5-1.1-3.5-.6S14.8 5 15 6c-3 .2-5.5-1-7.5-3-1 2-1 3.5.5 5C7 8 6 8 5 7.5c0 2 1.5 3.5 3.5 4-1 .5-2 .5-3 .3C7 13 8.7 14 10.7 14c-2.7 2-6 2-8.7 1.7C4 18 7 19 10 19c6 0 10.5-4.8 10.3-10.7 1-.7 1.7-1.7 2.7-3.3z" stroke="currentColor" stroke-width="0.5"/></svg>
          </a>
          <a href="#" aria-label="Instagram">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect x="2" y="2" width="20" height="20" rx="5" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/><circle cx="18" cy="6" r="1" fill="currentColor"/></svg>
          </a>
        </div>
      </div>
    </footer>

    <!-- Back to top button -->
    <a href="#home" class="btn back-to-top" aria-label="Back to top">Top</a>
    <div class="toast" role="status" aria-live="polite" aria-atomic="true" id="toast" hidden>Copied to clipboard</div>
    <div class="lightbox" id="lightbox" aria-modal="true" role="dialog" aria-label="Image preview">
      <button class="close" aria-label="Close">✕</button>
      <img alt="Preview" src="https://via.placeholder.com/1200x750.png?text=Jolly+Children" />
    </div>

    <script src="script.js"></script>
    <script>
      // Utility: set current year
      document.getElementById('year').textContent = new Date().getFullYear();

      // Mobile menu toggle (accessible)
      (function() {
        const toggle = document.querySelector('.menu-toggle');
        const nav = document.getElementById('primary-navigation');
        if (!toggle || !nav) return;
        const links = nav.querySelectorAll('a');

        function setExpanded(isOpen) {
          toggle.setAttribute('aria-expanded', String(isOpen));
          nav.classList.toggle('open', isOpen);
          if (isOpen) {
            // Focus first link for accessibility
            const first = links[0];
            first && first.focus({ preventScroll: true });
          }
        }
        toggle.addEventListener('click', () => {
          const isOpen = toggle.getAttribute('aria-expanded') === 'true';
          setExpanded(!isOpen);
        });
        // Close menu when a link is clicked (mobile)
        links.forEach(a => a.addEventListener('click', () => setExpanded(false)));
        // Close on Escape
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') setExpanded(false);
        });
      })();

      // Smooth-scroll focus management for skip-like anchor behavior
      (function() {
        const navLinks = document.querySelectorAll('a[href^="#"]');
        navLinks.forEach(link => {
          link.addEventListener('click', (e) => {
            const targetId = link.getAttribute('href');
            if (!targetId || targetId === '#') return;
            const target = document.querySelector(targetId);
            if (!target) return;
            // Allow default hash update, then focus target for accessibility
            setTimeout(() => {
              if (target.hasAttribute('tabindex')) {
                target.focus({ preventScroll: true });
              }
            }, 0);
          });
        });
      })();

      // Active link highlight on scroll (IntersectionObserver)
      (function() {
        const sections = ['#home', '#about', '#academics', '#facilities', '#admissions', '#contact']
          .map(id => document.querySelector(id))
          .filter(Boolean);
        const navLinks = Array.from(document.querySelectorAll('.nav-link'));
        if (!('IntersectionObserver' in window) || sections.length === 0) return;

        const byId = new Map(navLinks.map(a => [a.getAttribute('href'), a]));
        const obs = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            const id = '#' + entry.target.id;
            const link = byId.get(id);
            if (!link) return;
            if (entry.isIntersecting) {
              navLinks.forEach(l => l.classList.remove('active'));
              link.classList.add('active');
              link.setAttribute('aria-current', 'true');
              navLinks.filter(l => l !== link).forEach(l => l.removeAttribute('aria-current'));
            }
          });
        }, { rootMargin: '-40% 0px -55% 0px', threshold: 0.01 }); // Adjusted rootMargin

        sections.forEach(sec => obs.observe(sec));
      })();

      // Back to top button show/hide
      (function() {
        const btn = document.querySelector('.back-to-top');
        if (!btn) return;
        const toggle = () => {
          if (window.scrollY > 400) btn.classList.add('show'); else btn.classList.remove('show');
        };
        toggle();
        window.addEventListener('scroll', toggle, { passive: true });
      })();

      // FAQ Accordion behavior
      (function() {
        const headers = document.querySelectorAll('.accordion-header');
        headers.forEach((hdr) => {
          const panelId = hdr.getAttribute('aria-controls');
          const panel = panelId && document.getElementById(panelId);
          if (!panel) return;
          hdr.addEventListener('click', () => {
            const expanded = hdr.getAttribute('aria-expanded') === 'true';
            hdr.setAttribute('aria-expanded', String(!expanded));
            panel.hidden = expanded;
          });
          // Keyboard support via button element suffices (Space/Enter handled by browser)
        });
      })();

      // Scroll reveal animations (reduced-motion aware)
      (function() {
        const items = document.querySelectorAll('.reveal');
        if (!items.length) return;
        const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        if (prefersReduced || !('IntersectionObserver' in window)) {
          items.forEach(i => i.classList.add('in-view'));
          return;
        }
        const io = new IntersectionObserver((entries) => {
          entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('in-view'); io.unobserve(e.target); } });
        }, { threshold: 0.1, rootMargin: '0px 0px -10% 0px' });
        items.forEach(i => io.observe(i));
      })();

      // Academics filter chips
      (function() {
        const group = document.querySelector('.chip-group');
        const cards = document.querySelectorAll('#academics-grid .card');
        if (!group || !cards.length) return;
        group.addEventListener('click', (e) => {
          const btn = e.target.closest('.chip');
          if (!btn) return;
          const filter = btn.getAttribute('data-filter');
          const chips = group.querySelectorAll('.chip');
          chips.forEach(c => c.setAttribute('aria-pressed', String(c === btn)));
          cards.forEach(card => {
            const tags = (card.getAttribute('data-tags') || '').split(',');
            const show = filter === 'all' || tags.includes(filter);
            card.style.display = show ? '' : 'none';
          });
        });
      })();

      // FAQ deep-link via hash
      (function() {
        function openFromHash() {
          const id = location.hash.replace('#', '');
          if (!id) return;
          const header = document.getElementById(id + '-header');
          const panel = document.getElementById(id);
          if (header && panel) {
            header.setAttribute('aria-expanded', 'true');
            panel.hidden = false;
            setTimeout(() => header.scrollIntoView({ behavior: 'smooth', block: 'start' }), 0);
          }
        }
        window.addEventListener('hashchange', openFromHash);
        openFromHash();
      })();

      // Copy to clipboard with toast
      (function() {
        const toast = document.getElementById('toast');
        function showToast(msg) {
          if (!toast) return;
          toast.textContent = msg;
          toast.hidden = false;
          toast.classList.add('show');
          setTimeout(() => { toast.classList.remove('show'); toast.hidden = true; }, 1500);
        }
        document.addEventListener('click', async (e) => {
          const btn = e.target.closest('[data-copy]');
          if (!btn) return;
          const sel = btn.getAttribute('data-copy');
          const el = sel && document.querySelector(sel);
          if (!el) return;
          const text = el.textContent.trim();
          try {
            await navigator.clipboard.writeText(text);
            showToast('Copied to clipboard');
          } catch {
            showToast('Press Ctrl+C to copy');
          }
        });
      })();

      // Announcement bar (no theme toggle)
      (function() {
        const bar = document.getElementById('announce');
        const dismiss = bar && bar.querySelector('.dismiss');
        const key = 'jcac_banner_dismissed_v1';
        if (bar && !localStorage.getItem(key)) { bar.hidden = false; }
        dismiss && dismiss.addEventListener('click', () => { localStorage.setItem(key, '1'); bar.hidden = true; });
      })();

      // Stats count-up when visible
      (function() {
        const nums = document.querySelectorAll('.stat .num');
        if (!nums.length || !('IntersectionObserver' in window)) {
          // Fallback: set numbers immediately if observer unsupported
          nums.forEach(el => { el.textContent = (parseInt(el.getAttribute('data-count'),10) || 0).toLocaleString(); });
          return;
        }
        const io = new IntersectionObserver((entries, obs) => {
          entries.forEach(entry => {
            if (!entry.isIntersecting) return;
            const el = entry.target; const target = parseInt(el.getAttribute('data-count'), 10) || 0;
            const start = 0; const duration = 1000; const t0 = performance.now();
            function tick(now) {
              const p = Math.min(1, (now - t0) / duration);
              el.textContent = Math.floor(start + (target - start) * p).toLocaleString();
              if (p < 1) requestAnimationFrame(tick);
            }
            requestAnimationFrame(tick);
            obs.unobserve(el);
          });
        }, { threshold: 0.2 });
        nums.forEach(n => io.observe(n));
        // Safety: if for some reason observer doesn't trigger within 500ms, set numbers
        setTimeout(() => {
          nums.forEach(el => { if (!el.textContent || el.textContent.trim() === '0') el.textContent = (parseInt(el.getAttribute('data-count'),10) || 0).toLocaleString(); });
        }, 500);
      })();

      // Testimonials carousel
      (function() {
        const track = document.getElementById('carousel-track');
        const prev = document.getElementById('prev');
        const next = document.getElementById('next');
        const slides = Array.from(track.children).filter(slide => !slide.classList.contains('hidden-slide'));
        const dots = Array.from(document.querySelectorAll('.dots .dot'));

        if (!track || !prev || !next || !dots.length || slides.length !== dots.length) return;

        let index = 0;
        const total = slides.length;

        function update() {
          // Use transform to slide the entire track
          track.style.transform = `translateX(-${index * 100}%)`;

          dots.forEach((d, i) => d.classList.toggle('active', i === index));
          dots.forEach((d, i) => d.setAttribute('aria-selected', String(i === index)));
        }

        prev.addEventListener('click', () => { index = (index - 1 + total) % total; update(); });
        next.addEventListener('click', () => { index = (index + 1) % total; update(); });
        dots.forEach((d, i) => d.addEventListener('click', () => { index = i; update(); }));
        
        update(); // Set initial state

        let timer = setInterval(() => { next.click() }, 6000);
        track.addEventListener('mouseenter', () => clearInterval(timer));
        track.addEventListener('mouseleave', () => { timer = setInterval(() => { next.click() }, 6000); });
      })();

      // Lightbox for hero image
      (function() {
        const trigger = document.querySelector('.hero-lightbox-trigger');
        const lb = document.getElementById('lightbox');
        const close = lb && lb.querySelector('.close');
        if (!trigger || !lb || !close) return;
        trigger.addEventListener('click', () => { lb.classList.add('open'); });
        close.addEventListener('click', () => { lb.classList.remove('open'); });
        lb.addEventListener('click', (e) => { if (e.target === lb) lb.classList.remove('open'); });
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') lb.classList.remove('open'); });
      })();

      // Contact Form Submission
      (function() {
        const form = document.getElementById('contact-form');
        const formNote = document.getElementById('form-note');
        if (!form || !formNote) return;

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());
          const submitButton = form.querySelector('button[type="submit"]');

          submitButton.disabled = true;
          formNote.textContent = 'Sending...';

          try {
            const response = await fetch('/api/contact', { // Your future backend endpoint
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(data),
            });

            if (response.ok) {
              formNote.textContent = 'Message sent successfully!';
              form.reset();
            } else {
              throw new Error('Something went wrong.');
            }
          } catch (error) {
            formNote.textContent = 'Error: Could not send message.';
          } finally {
            submitButton.disabled = false;
          }
        });
      })();

  // FINAL: Responsive Facebook Plugin Fix
      window.addEventListener('load', function() {
        function resizeFacebookPlugin() {
          const container = document.querySelector('.facebook-plugin-container');
          if (!container) return;

          // The timeout ensures the plugin has rendered once before we try to resize it
          setTimeout(function() {
            const fbPage = container.querySelector('.fb-page');
            if (fbPage) {
              const containerWidth = container.offsetWidth;
              fbPage.setAttribute('data-width', containerWidth);
              if (window.FB) {
                window.FB.XFBML.parse(container);
              }
            }
          }, 500); // A small delay can help
        }

        // Resize on initial load
        resizeFacebookPlugin();
        // Resize on window resize
        window.addEventListener('resize', resizeFacebookPlugin);
        // If the FB SDK is not available (e.g., appId missing or blocked), show iframe fallback
        setTimeout(function() {
          if (!window.FB) {
            const iframeWrap = document.querySelector('.fb-page-iframe-wrapper');
            const embedWrap = document.querySelector('.fb-embed-wrapper');
            if (iframeWrap && embedWrap) {
              iframeWrap.style.display = 'block';
              iframeWrap.setAttribute('aria-hidden', 'false');
            }
          }
        }, 1200);
      });

    </script>

    <script>
(async function populateFacilities() {
  const grid = document.getElementById('facilities-grid');
  if (!grid) return;

  function escHtml(s) { return String(s || '').replace(/[&<>"']/g, (c) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
  function escAttr(s) { return escHtml(s); }

  const placeholder = 'data:image/svg+xml;utf8,' + encodeURIComponent(
    '<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="800" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid slice">' +
    '<rect width="100%" height="100%" fill="#e8f5e9"/>' +
    '<g fill="#a5d6a7"><rect x="90" y="120" width="440" height="280" rx="12"/><rect x="620" y="120" width="440" height="280" rx="12"/></g>' +
    '<text x="50%" y="62%" text-anchor="middle" fill="#2E7D32" font-family="Inter,Roboto,Arial" font-size="36">No image available</text>' +
    '</svg>'
  );

  // Try common public path prefixes for bare filenames
  const publicPrefixes = ['/uploads/', '/resources/', '/public/uploads/', '/images/'];

  // Resolve image from many possible shapes
  function resolveImageSrc(item) {
    if (!item) return null;

    // Helper to pick first valid string url-like value
    function firstString(values) {
      for (const v of values) {
        if (!v && v !== 0) continue;
        if (typeof v === 'string' && v.trim()) return v.trim();
      }
      return null;
    }

    // If any common direct fields exist
    const directFields = [
      'imageUrl','photoUrl','url','path','image','photo',
      'photoPath','file','filename','fileName','publicUrl','public_url'
    ];
    let val = firstString(directFields.map(f => item[f]));
    if (val) return normalizeSrc(val);

    // If item.image / item.photo is an object with url/path/filename
    const objCandidates = ['image','photo','file','media'];
    for (const k of objCandidates) {
      const v = item[k];
      if (!v) continue;
      if (typeof v === 'string' && v.trim()) return normalizeSrc(v.trim());
      if (Array.isArray(v) && v.length) {
        // try first element
        const first = v[0];
        if (typeof first === 'string') return normalizeSrc(first);
        if (first && typeof first === 'object') {
          const nested = firstString([first.url, first.path, first.filename, first.fileName, first.publicUrl, first.public_url]);
          if (nested) return normalizeSrc(nested);
        }
      }
      if (v && typeof v === 'object') {
        const nested = firstString([v.url, v.path, v.filename, v.fileName, v.publicUrl, v.public_url]);
        if (nested) return normalizeSrc(nested);
      }
    }

    // If the item has an images/photos array (common)
    const arrFields = ['images','photos','gallery','files','media'];
    for (const a of arrFields) {
      const arr = item[a];
      if (!Array.isArray(arr) || !arr.length) continue;
      const first = arr[0];
      if (typeof first === 'string') return normalizeSrc(first);
      if (first && typeof first === 'object') {
        const nested = firstString([first.url, first.path, first.filename, first.fileName, first.publicUrl, first.public_url]);
        if (nested) return normalizeSrc(nested);
      }
    }

    // Last resort: if item has 'id' and a filename field elsewhere, try to form a path
    if (item.filename && typeof item.filename === 'string') return normalizeSrc(item.filename);

    return null;
  }

  // Normalize src: if absolute URL return as-is, if looks like "bucket/path" or has no leading slash try known prefixes
  function normalizeSrc(src) {
    if (!src) return null;
    src = String(src);
    // If already absolute, return
    if (/^https?:\/\//i.test(src) || src.startsWith('data:')) return src;
    const origin = window.location && window.location.origin ? window.location.origin : (location.protocol + '//' + location.host);
    // If starts with a slash, prefix with current origin so port is preserved
    if (src.startsWith('/')) return encodeURI(origin + src);
    // If looks like storage path with bucket/object (e.g. "bucket/dir/file.jpg"), try to return as-is (may be resolved by server)
    if (/^[^\/]+\/.+\.[a-zA-Z]{2,5}$/.test(src)) {
      // Try with /uploads/ first if file-like (no scheme)
      for (const p of publicPrefixes) {
        const candidate = p + src;
        // leave normalization to caller (no availability check here)
        return encodeURI(origin + candidate);
      }
    }
    // If it's just a filename, try common public locations
    if (/^[^\/]+\.[a-zA-Z]{2,5}$/.test(src)) {
      for (const p of publicPrefixes) {
        const candidate = p + src;
        return encodeURI(origin + candidate);
      }
    }
    // otherwise return as relative path
    return encodeURI(origin + '/' + src.replace(/^\/+/, ''));
  }

  try {
    const res = await fetch('/api/facilities', { cache: 'no-store' });
    if (!res.ok) throw new Error('Failed to fetch facilities (' + res.status + ')');
    const data = await res.json();

    console.debug('populateFacilities: API returned', data);

    if (!Array.isArray(data) || data.length === 0) {
      grid.innerHTML = '<p class="muted">No facilities found.</p>';
      return;
    }

    const cards = data.map(f => {
      const src = resolveImageSrc(f);
      const imgSrc = src || placeholder;
      const title = f.name || f.title || f.facilityName || 'Facility';
      const desc = f.description || f.desc || f.summary || '';

      // For debugging: include dataset with chosen src
      return (
        '<article class="card" data-id="' + escAttr(f.id || f._id || '') + '" data-src="' + escAttr(src || '') + '">' +
          '<div class="hero-img" style="aspect-ratio:16/10; overflow:hidden; border-radius:12px;">' +
            '<img loading="lazy" src="' + escAttr(imgSrc) + '" alt="' + escAttr(title) + '" style="width:100%;height:100%;object-fit:cover;display:block;" ' +
              'onerror="this.onerror=null;this.src=\'' + placeholder + '\';" />' +
          '</div>' +
          '<h3 style="margin-top:0.75rem;">' + escHtml(title) + '</h3>' +
          (desc ? '<p class="muted">' + escHtml(desc) + '</p>' : '') +
        '</article>'
      );
    });

    grid.innerHTML = cards.join('');
  } catch (err) {
    console.warn('populateFacilities error:', err);
    grid.innerHTML = '<p class="muted">Unable to load facilities at this time.</p>';
  }
})();
</script>
  </body>
</html>


